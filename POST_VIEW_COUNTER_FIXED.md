# ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –æ—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –Ω–æ–≤–æ—Å—Ç–µ–π - –í—ã–ø–æ–ª–Ω–µ–Ω–æ!

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

**–û—à–∏–±–∫–∞:**
```
BadMethodCallException
Call to undefined method App\Models\WordPress\Post::setMeta()
```

**–ü—Ä–∏—á–∏–Ω–∞:**
- –í –º–æ–¥–µ–ª–∏ `Post` –±—ã–ª –æ–ø—Ä–µ–¥–µ–ª–µ–Ω –º–µ—Ç–æ–¥ `getMeta()` –¥–ª—è —á—Ç–µ–Ω–∏—è –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö
- –ù–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–æ–≤–∞–ª –º–µ—Ç–æ–¥ `setMeta()` –¥–ª—è –∑–∞–ø–∏—Å–∏ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö
- –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä `FrontendController::post()` –ø—ã—Ç–∞–ª—Å—è —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ `setMeta()`

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `setMeta()` –≤ –º–æ–¥–µ–ª—å `Post`

**–§–∞–π–ª:** `app/Models/WordPress/Post.php`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```php
// –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–∞-–ø–æ–ª—è
public function setMeta(string $key, $value)
{
    $meta = $this->meta()->where('meta_key', $key)->first();
    
    if ($meta) {
        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å
        $meta->update(['meta_value' => $value]);
    } else {
        // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
        $this->meta()->create([
            'meta_key' => $key,
            'meta_value' => $value
        ]);
    }
    
    return $this;
}
```

---

## üéØ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö (getMeta)

```php
// –ß—Ç–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
$views = $post->getMeta('post_views_count', 0);
// –ï—Å–ª–∏ –∫–ª—é—á –Ω–µ –Ω–∞–π–¥–µ–Ω, –≤–µ—Ä–Ω–µ—Ç 0
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö (setMeta)

```php
// –ó–∞–ø–∏—Å—å –∑–Ω–∞—á–µ–Ω–∏—è
$post->setMeta('post_views_count', $views + 1);
```

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
1. –ò—â–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∑–∞–ø–∏—Å—å –ø–æ –∫–ª—é—á—É `meta_key`
2. –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí –æ–±–Ω–æ–≤–ª—è–µ—Ç `meta_value`
3. –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å
4. –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `$this` –¥–ª—è —Ü–µ–ø–æ—á–∫–∏ –≤—ã–∑–æ–≤–æ–≤

---

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ WordPress –º–µ—Ç–∞-–¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `wp_postmeta`:

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|----------|
| `meta_id` | BIGINT | ID –∑–∞–ø–∏—Å–∏ (PK) |
| `post_id` | BIGINT | ID –ø–æ—Å—Ç–∞ (FK ‚Üí wp_posts.ID) |
| `meta_key` | VARCHAR | –ö–ª—é—á –º–µ—Ç–∞-–ø–æ–ª—è |
| `meta_value` | LONGTEXT | –ó–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç–∞-–ø–æ–ª—è |

### –ü—Ä–∏–º–µ—Ä—ã –º–µ—Ç–∞-–ø–æ–ª–µ–π:

```
meta_key                 | meta_value
-------------------------|------------
_thumbnail_id            | 12345
post_views_count         | 150
_edit_last               | 1
custom_field             | some value
```

---

## üîÑ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ

**–§–∞–π–ª:** `app/Http/Controllers/FrontendController.php`

```php
public function post(string $slug)
{
    $post = Post::where('post_name', $slug)->firstOrFail();
    
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤
    $views = (int) $post->getMeta('post_views_count', 0);  // –ß–∏—Ç–∞–µ–º
    $post->setMeta('post_views_count', $views + 1);        // –ó–∞–ø–∏—Å—ã–≤–∞–µ–º
    
    return view('frontend.post', compact('post'));
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º –æ—Ç–∫—Ä—ã—Ç–∏–∏ –Ω–æ–≤–æ—Å—Ç–∏ —Å—á–µ—Ç—á–∏–∫ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω–∞ 1
- –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ `wp_postmeta`
- –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ø—É–ª—è—Ä–Ω–æ—Å—Ç–∏

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –¶–µ–ø–æ—á–∫–∞ –≤—ã–∑–æ–≤–æ–≤:

```php
$post->setMeta('views', 100)
     ->setMeta('likes', 50)
     ->setMeta('featured', true);
```

### –£–¥–∞–ª–µ–Ω–∏–µ –º–µ—Ç–∞-–ø–æ–ª—è:

–ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –º–µ—Ç–æ–¥ `deleteMeta()`:

```php
public function deleteMeta(string $key)
{
    $this->meta()->where('meta_key', $key)->delete();
    return $this;
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è:

```php
public function hasMeta(string $key): bool
{
    return $this->meta()->where('meta_key', $key)->exists();
}
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:**

‚úÖ –û—Ç–∫—Ä—ã—Ç–∏–µ –Ω–æ–≤–æ—Å—Ç–µ–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
‚úÖ –°—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è  
‚úÖ –ú–µ—Ç–∞-–¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î  
‚úÖ –ú–µ—Ç–æ–¥—ã `getMeta()` –∏ `setMeta()` —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –ø–∞—Ä–µ  
‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å WordPress —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π  

**–ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ**

---

## üîß –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –í –±—Ä–∞—É–∑–µ—Ä–µ:
```
http://localhost:8002/news/–Ω–∞–∑–≤–∞–Ω–∏–µ-–Ω–æ–≤–æ—Å—Ç–∏
```

### –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:
```sql
SELECT * FROM wp_postmeta 
WHERE meta_key = 'post_views_count' 
ORDER BY meta_value DESC;
```

**–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:**
- –ù–æ–≤–æ—Å—Ç—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- –°—á–µ—Ç—á–∏–∫ –≤ `wp_postmeta` —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø—Ä–æ—Å–º–æ—Ç—Ä–µ

